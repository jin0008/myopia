import{r as a,U as x,d as u,u as j,j as e}from"./index-Ci6lT7C_.js";import{u as l}from"./useMutation-D6MJQ69v.js";import{b as f,g as y}from"./hospital-DZ8E4L1t.js";import{d as h}from"./styled-components.browser.esm-Db0Q2RpU.js";import{b as v,d as g}from"./healthcare_professional-DU4E_weG.js";import{P as c,a as b}from"./button-DpILQc1R.js";import{T as C}from"./div-Coub_ivx.js";import{S}from"./input-dlL0Jff_.js";import"./theme-Dljabw6R.js";const _=h.table`
  text-align: center;
  height: fit-content;
  & td {
    padding: 8px;
  }
`;function D(){const{user:i}=a.useContext(x),[t,n]=a.useState(""),o=u({queryKey:["hospital",t,"member"],queryFn:()=>f(t),enabled:!!t}),d=j(),s=l({mutationFn:({userId:r,data:p})=>v(r,p),onSuccess:()=>{d.invalidateQueries({queryKey:["hospital",t,"member"]})}}),m=l({mutationFn:r=>g(r),onSuccess:()=>{d.invalidateQueries({queryKey:["hospital",t,"member"]})}});return i?.is_site_admin?e.jsxs(C,{children:[e.jsx("h1",{children:"Admin Page"}),e.jsxs("div",{style:{display:"flex",width:"80%",flexGrow:1,height:0,justifyContent:"space-between"},children:[e.jsx(q,{onSelect:n}),e.jsxs("div",{children:[e.jsx("h2",{children:"Member List"}),e.jsxs(_,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User ID"}),e.jsx("th",{children:"name"}),e.jsx("th",{children:"approve"}),e.jsx("th",{children:"reject/kick"}),e.jsx("th",{children:"admin"})]})}),e.jsx("tbody",{children:o.data?.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:r.user_id}),e.jsx("td",{children:r.name}),e.jsx("td",{children:r.approved?"Approved":e.jsx(c,{onClick:()=>s.mutate({userId:r.user_id,data:{approved:!0}}),children:"Approve"})}),e.jsx("td",{children:e.jsx(c,{onClick:()=>m.mutate(r.user_id),children:r.approved?"Kick":"Reject"})}),e.jsx("td",{children:r.is_admin?e.jsx(b,{onClick:()=>s.mutate({userId:r.user_id,data:{is_admin:!1}}),children:"Set as not admin"}):r.approved?e.jsx(c,{onClick:()=>s.mutate({userId:r.user_id,data:{is_admin:!0}}),children:"Set as admin"}):e.jsx(e.Fragment,{})})]},r.user_id))})]})]})]})]}):e.jsx("div",{children:"Not authorized"})}const k=h.div`
  padding: 8px;
  border: 1px solid black;
  cursor: pointer;
  border-radius: 8px;
  &:hover {
    background-color: lightgray;
  }
`;function L({hospital:i,onSelect:t}){return e.jsxs(k,{onClick:t,children:[e.jsxs("p",{children:[i.name,"(",i.country.code,")"]}),e.jsxs("p",{children:["Code: ",i.code]})]})}function q({onSelect:i}){const t=u({queryKey:["hospital"],queryFn:y}),[n,o]=a.useState(""),d=a.useMemo(()=>t.data?t.data.filter(s=>s.name.toLowerCase().includes(n.toLowerCase())||s.code.includes(n)):[],[t.data,n]);return t.isLoading?e.jsx("div",{children:"Loading..."}):t.isError?e.jsxs("div",{children:["Error: ",t.error.message]}):e.jsxs("div",{children:[e.jsx("h2",{children:"Hospital List"}),e.jsx(S,{placeholder:"Search hospital by name or code",value:n,onChange:s=>o(s.target.value)}),e.jsx("div",{children:d.map(s=>e.jsx(L,{hospital:s,onSelect:()=>i(s.id)},s.id))})]})}export{D as default};
